<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CSE 111 - Prepare</title>
    <link rel="stylesheet" type="text/css" href="../site/style.css" />
</head>

<body>
<header>
    <div class="logo">
        <div class="upper">BYU</div>
        <div class="lower">Idaho</div>
    </div>
    <h1>CSE 111 | Programming with Functions</h1>
</header>
<article>
<!-- in the time that you have, you can test one or two values.
regression tests - keep them around and run later.

-->

    <h1>07 Prepare: Testing Code</h1>
    <p>During this lesson, you will learn to use a more systematic
    approach to developing code. Specifically, you will learn how to
    write test functions that automatically verify that other functions
    are correct. You will learn how to use a Python module named
    <code>pytest</code> to run your test functions, and you will learn
    how to read the output of <code>pytest</code> to help you find and
    fix mistakes in your code.</p>

    <h2>Concepts</h2>
    <p>Here are the Python programming concepts and topics that you
    should learn this week:</p>
    <ol>
        <li><div>During previous lessons, you tested your programs by
        running them, typing user input, reading the output, and
        verifying that the output was correct. This is a valid way to
        test a program. However, it is time consuming, tedious, and
        error prone. A much better way to test a program is to test its
        functions individually and to write test functions that
        <em>automatically</em> verify that the program's functions are
        correct.</div></li>

        <li><div><code>pytest</code> is a Python module that makes it
        easy to write and run test functions. During the checkpoint of
        this lesson, you will install and use <code>pytest</code>. There
        are other Python testing modules besides <code>pytest</code>,
        but <code>pytest</code> seems to be the easiest.</div></li>

        <li><div><code>pytest</code> allows us to write simple test
        functions that use the built-in Python <a target="_blank"
        href="https://docs.python.org/3/reference/simple_stmts.html#the-assert-statement"><code>assert</code></a>
        statement to verify that a function returns a correct result.
        For example, if we want to verify that the built-in
        <code>min</code> function works correctly, we could write an
        <code>assert</code> statement like this:
<div class="pre"><pre class="python">assert min(7, -3, 0, 2) == -3</pre></div>
        The previous line of code will cause the computer to first call
        the <code>min</code> function and pass 7, -3, 0, and 2 as
        parameters to the <code>min</code> function. The
        <code>min</code> function will find the minimum value of its
        parameters and return that minimum value. Then the
        <code>assert</code> statement will compare the returned minimum
        value to -3. If the returned minimum value is not -3, the
        <code>assert</code> statement will raise an exception which will
        cause <code>pytest</code> to print an error message.</div></li>

        <li><div>In this course, you will write your test functions in a
        Python file that is separate from your Python program. In other
        words, you will keep normal program code and test code in
        separate files.</div></li>

        <li><div>To test a function you should do the following:
        <ol>
            <li><div>Write a function that is part of your normal Python
            program.</div></li>
            <li><div>Think about different parameter values that will
            cause the computer to execute all the code in your function
            and will possibly cause your function to fail or return an
            incorrect result.</div></li>
            <li><div>In a separate Python file, write a test function
            that calls your program function and uses an assert
            statement to <em>automatically</em> verify that the value
            returned from your program function is correct.</div></li>
            <li><div>Use <code>pytest</code> to run the test
            function.</div></li>
            <li><div>Read the output of <code>pytest</code> and use that
            output to help you find and fix mistakes in both your program
            function and test function.</div></li>
        </ol></div></li>
    </ol>

        <h2>Example</h2>
        <p>Here is a simple function named <code>cels_from_fahr</code>
        that converts a temperature in Fahrenheit to Celsius and that is
        part of a larger Python program in a file named
        <code>weather.py</code>:</p>

<div class="pre"><pre class="python">def cels_from_fahr(fahr):
    """Convert a temperature in Fahrenheit to
    Celsius and return the Celsius temperature.
    """
    cels = (fahr - 32) * 5 / 9
    return cels</pre></div>

        <p>We want to test the <code>cels_from_fahr</code> function.
        From the function header, we see that
        <code>cels_from_fahr</code> takes one parameter named
        <code>fahr</code>. To adequately test this function we should
        call it with at least a negative number, zero, and a positive
        number, so we write this test function in a separate file named
        <code>test_weather.py</code>:</p>

<div class="pre"><pre class="python">from weather import cels_from_fahr

def test_cels_from_fahr():
    assert round(cels_from_fahr(-25), 1) == -31.7
    assert round(cels_from_fahr(0), 1) == -17.8
    assert round(cels_from_fahr(32), 1) == 0
    assert round(cels_from_fahr(70), 1) == 21.1</pre></div>

        <p>Then we use <code>pytest</code> to run the test function like
        this:</p>

<pre class="console">&gt; python -m pytest test_weather.py
========================= test session starts =========================
platform win32 -- Python 3.7.6, pytest-5.3.5, py-1.8.1, pluggy-0.13.1
rootdir: C:\Users\barzee\cse111\weather
collected 1 item

weather.py .                                                     [100%]

========================== 1 passed in 0.02s ==========================</pre>

        <p><code>pytest</code> runs the <code>test_cels_from_fahr</code>
        function which calls the <code>cels_from_fahr</code> function
        four times and verifies that the value returned
        <code>cels_from_fahr</code> is correct. We can see from the
        output of pytest, "[100%] and 1 passed" that the cels_from_fahr
        function return the expected (correct) result all four
        times.</p>

        <li><div></div></li>

        <li><div></div></li>
</article>
</body>
</html>
